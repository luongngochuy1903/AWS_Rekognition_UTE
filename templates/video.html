<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>AWS Rekognition Video Demo</title>
    <style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        margin: 20px;
        line-height: 1.5;
        background-color: #f0f2f5; /* nền tổng thể nhạt */
        color: #2c3e50;
    }

    h2 {
        margin-top: 0;
        font-size: 22px;
        color: #34495e; /* tiêu đề chuyên nghiệp */
    }

    .container {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
    }

    .column {
        flex: 1;
        border-radius: 10px;
        padding: 20px;
        min-width: 280px;
        background-color: #ffffff; /* nền trắng cơ bản */
        border-left: 5px solid #3498db;
        box-shadow: 0 4px 8px rgba(0,0,0,0.08);
        transition: transform 0.2s, box-shadow 0.2s, background-color 0.3s;
    }

    /* thêm màu nền nhạt cho column hover */
    .column:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0,0,0,0.12);
        background-color: #f1f8ff; /* xanh nhạt khi hover */
    }

    /* các loại column khác nhau có thể thêm class riêng */
    .column.face { background-color: #fcfbf7; }       /* vàng nhạt */
    .column.text { background-color: #f0fcf7; }       /* xanh lá nhạt */
    .column.celebrity { background-color: #f7f0fc; }  /* tím nhạt */

    .column img {
        max-width: 100%;
        max-height: 200px;
        display: block;
        margin-bottom: 12px;
        border-radius: 6px;
        object-fit: cover;
    }

    button {
        margin: 8px 0;
        padding: 10px 16px;
        font-size: 14px;
        cursor: pointer;
        border-radius: 6px;
        border: none;
        background-color: #2980b9;
        color: #fff;
        transition: background 0.3s;
    }

    button:hover {
        background-color: #1c5980;
    }

    input[type="file"] {
        margin-bottom: 12px;
    }

    pre {
        background: #ecf0f1;
        padding: 12px;
        border-radius: 6px;
        max-height: 350px;
        overflow: auto;
        font-size: 13px;
        color: #2c3e50;
    }
</style>

</head>
<body>

<h1>AWS Rekognition Video Demo</h1>

<div class="container">

    <!-- Cột 1: Upload video -->
    <div class="column">
        <h2>Upload Video to S3</h2>
        <input type="file" id="video_file" accept="video/*">
        <button id="upload_video">Upload Video</button>
        <h3>Upload Result</h3>
        <pre id="upload_result">Chưa có kết quả</pre>
    </div>

    <!-- Cột 2: API Buttons -->
    <div class="column">
        <h2>API Calls</h2>
        <button id="detect_labels">Detect Labels</button>
        <button id="detect_faces">Detect Faces</button>
        <button id="detect_text">Detect Text</button>
        <button id="celebrity_recognition">Celebrity Recognition</button>
    </div>

    <!-- Cột 3: JSON Result -->
    <div class="column">
        <h2>API Result</h2>
        <pre id="api_result">Chưa có kết quả</pre>
    </div>

</div>

<script>
let uploadedFileKey = "";

// Upload video
document.getElementById("upload_video").addEventListener("click", async () => {
    const fileInput = document.getElementById("video_file");
    if (!fileInput.files[0]) { alert("Hãy chọn video!"); return; }

    const formData = new FormData();
    formData.append("video", fileInput.files[0]);

    const res = await fetch("/video/upload", { method: "POST", body: formData });
    const result = await res.json();

    uploadedFileKey = result.file_name || "";
    document.getElementById("upload_result").textContent = JSON.stringify(result, null, 2);
});

// Hàm gọi API chung
async function callApi(endpoint) {
    if (!uploadedFileKey) { alert("Chưa upload video!"); return; }

    const formData = new FormData();
    formData.append("s3_file", uploadedFileKey);

    const res = await fetch(endpoint, { method: "POST", body: formData });
    const result = await res.json();

    document.getElementById("api_result").textContent = JSON.stringify(result, null, 2);
}

// Buttons API
document.getElementById("detect_labels").addEventListener("click", () => callApi("/video/label-detect"));
document.getElementById("detect_faces").addEventListener("click", () => callApi("/video/face-detect"));
document.getElementById("detect_text").addEventListener("click", () => callApi("/video/text-detect"));
document.getElementById("celebrity_recognition").addEventListener("click", () => callApi("/video/celebrity-recognition"));
</script>

</body>
</html>
